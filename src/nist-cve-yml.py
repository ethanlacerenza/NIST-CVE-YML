import requests
import yaml

def get_cve_info(cve_id):
    base_url = "https://services.nvd.nist.gov/rest/json/cve/1.0/"

    try:
        response = requests.get(base_url + cve_id)
        response.raise_for_status()

        cve_data = response.json()
        return cve_data
    except requests.exceptions.RequestException as e:
        print(f"Errore nella richiesta: {e}")
        return None

def main():
    cve_ids = input("").split(',')

    cve_info = {}
    for cve_id in cve_ids:
        cve_id = cve_id.strip()
        cve_data = get_cve_info(cve_id)

        if cve_data:
            cve_info[cve_id] = cve_data

    if cve_info:
        with open("cve_info.yml", "w") as f:
            yaml.dump(cve_info, f, default_flow_style=False)
        print(f"Get 'cve_info.yml'.")
    else:
        print("No information found.")

if __name__ == "__main__":
    main()

